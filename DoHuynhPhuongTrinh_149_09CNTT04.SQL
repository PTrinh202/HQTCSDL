GO
CREATE TABLE MONHOC(
	MAMON CHAR(5) PRIMARY KEY,
	TENMON NVARCHAR(20),
	SOTC INT
);
CREATE TABLE DIEM(
	MASV CHAR(5) PRIMARY KEY,
	MAMON CHAR(5) CONSTRAINT FK_MAMON REFERENCES MONHOC(MAMON),
	DIEMTHI FLOAT
);
CREATE TABLE SINHVIEN(
	MASV CHAR(5) PRIMARY KEY,
	HOTEN NVARCHAR(50),
	NGSINH DATE
);
INSERT MONHOC VALUES
	('CSDL', 'CSDL NÂNG CAO'),
	('MTT', 'MẠNG MÁY TÍNH'),
	('TCC', 'TOÁN CAO CẤP')
INSERT DIEM VALUES
	('01', 'CSDL', '8.5'),
	('02', 'MTT', '7'),
	('03', 'TCC', '7'),
	('01', 'TCC', '6.5'),
	('02', 'TCC', '5')
INSERT SINHVIEN VALUES
	('01', 'ĐINH TOÀN', '1999-10-22'),
	('02', 'NGUYÊN LÊ', '1999-12-12'),
	('03', 'LÊ MINH', '2000-4-5')
GO
SELECT * FROM MONHOC
GO
SELECT * FROM DIEM
GO
SELECT * FROM SINHVIEN
--CÂU 2
GO
CREATE FUNCTION DIEMSV (@MH NVARCHAR(20))
RETURNS int
AS
	BEGIN 
		DECLARE @DEM int
		SET @DEM = (SELECT COUNT(*) FROM DIEM WHERE @DEM < 5)
		RETURN @DEM
	END
GO
SELECT dbo.DIEMSV('MTT')
--CÂU 3
GO
CREATE PROC t_DIEM (@MASV CHAR (5), @MAMON CHAR(5), @DIEMTHI FLOAT)
AS
INSERT INTO DIEM (MASV, MAMON, DIEMTHI) VALUES (@MASV, @MAMON, @DIEMTHI)
GO
INSERT DIEM VALUES ('03', 'CSDL', '6')

--CÂU 4
GO
CREATE TRIGGER THEM_SUA
ON DIEM
FOR  INSERT, UPDATE
AS
IF(SELECT DIEMTHI FROM inserted)>10 and (SELECT DIEMTHI FROM inserted)<0
BEGIN
	PRINT 'KHÔNG CHO PHÉP'
	ROLLBACK TRANSACTION
END
INSERT DIEM VALUES ('02','MTT','2')
